/* src/styles/index.css */
@tailwind base;
@tailwind components;
@tailwind utilities;

@layer base {
    :root {
        /* Define CSS variables from Tailwind config for potential use in JS or complex scenarios */
        --primary: hsl(210 100% 50%);
        --primary-foreground: hsl(0 0% 100%);
        --primary-h: 210;
        --primary-s: 100%;
        --primary-l: 50%;

        --canvas: hsl(220 40% 98%);
        --border: hsl(215 20% 85%);
        --muted: hsl(215 10% 55%);
        --muted-foreground: hsl(215 10% 65%);
        --destructive: hsl(0 75% 55%);

        /* Default border radius */
        --radius: 6px;
    }

    /* Optional: Apply dark mode based on system preference or class */
    /* .dark { ... } */

    body {
        @apply bg-canvas text-gray-900 font-sans antialiased overflow-hidden;
        -webkit-font-smoothing: antialiased;
        -moz-osx-font-smoothing: grayscale;
    }

    /* Ensure focus outlines are visible but styled subtly */
    *:focus-visible {
        @apply outline-none ring-1 ring-primary/60 ring-offset-1 ring-offset-canvas;
    }

    /* Remove default button focus outline if :focus-visible is supported */
    button:focus {
        outline: none;
    }
    button:focus:not(:focus-visible) {
        outline: none;
    }

    /* Style selection */
    ::selection {
        @apply bg-primary/30 text-gray-900;
    }
}

@layer utilities {
    /* Default Scrollbar Styling */
    .styled-scrollbar {
        scrollbar-width: thin; /* Firefox */
        scrollbar-color: theme('colors.border') transparent; /* Firefox */
    }

    /* Webkit browsers */
    .styled-scrollbar::-webkit-scrollbar {
        width: 8px; /* Width of the scrollbar */
        height: 8px; /* Height for horizontal scrollbar */
    }

    .styled-scrollbar::-webkit-scrollbar-track {
        background: transparent; /* Track background */
        border-radius: 4px;
    }

    .styled-scrollbar::-webkit-scrollbar-thumb {
        background-color: theme('colors.border-alt'); /* Color of the scroll thumb */
        border-radius: 4px; /* Roundness of the scroll thumb */
        border: 2px solid transparent; /* Creates padding around thumb */
        background-clip: content-box; /* Ensures border creates padding */
    }

    .styled-scrollbar::-webkit-scrollbar-thumb:hover {
        background-color: theme('colors.border'); /* Color on hover */
    }

    /* Thin Scrollbar Variant */
    .styled-scrollbar-thin {
        scrollbar-width: thin;
        scrollbar-color: hsl(215 20% 80% / 0.7) transparent;
    }

    .styled-scrollbar-thin::-webkit-scrollbar {
        width: 6px;
        height: 6px;
    }

    .styled-scrollbar-thin::-webkit-scrollbar-track {
        background: transparent;
    }

    .styled-scrollbar-thin::-webkit-scrollbar-thumb {
        background-color: hsl(215 20% 80% / 0.7);
        border-radius: 3px;
        border: 1px solid transparent;
        background-clip: content-box;
    }

    .styled-scrollbar-thin::-webkit-scrollbar-thumb:hover {
        background-color: hsl(215 20% 70% / 0.8);
    }

    /* Class for CodeMirror theme application */
    .cm-theme-custom {
        height: 100%;
        font-size: 13.5px; /* Corresponds to base font size approx */
        background-color: transparent;
        border-radius: inherit;
    }
    .cm-theme-custom .cm-scroller {
        font-family: theme('fontFamily.mono');
        line-height: 1.65;
        overflow: auto; /* Ensure scrolling */
        position: relative;
        background-color: transparent !important;
        height: 100%;
        outline: none;
    }
    .cm-theme-custom .cm-content {
        padding: 14px 16px;
        caret-color: theme('colors.primary.DEFAULT');
        background-color: transparent !important;
        outline: none;
        white-space: pre-wrap; /* Ensure wrapping and new lines work */
        word-wrap: break-word;
    }
    .cm-theme-custom .cm-gutters {
        background-color: hsla(220, 40%, 98%, 0.65);
        border-right: 1px solid hsla(210, 20%, 85%, 0.4);
        color: theme('colors.muted.foreground');
        padding-left: 8px;
        padding-right: 4px;
        font-size: theme('fontSize.2xs');
        user-select: none;
        -webkit-user-select: none;
        backdrop-filter: blur(10px);
        -webkit-backdrop-filter: blur(10px);
    }
    .cm-theme-custom .cm-lineNumbers .cm-gutterElement {
        min-width: 24px;
        text-align: right;
    }
    .cm-theme-custom .cm-line {
        padding: 0 4px;
    }
    .cm-theme-custom .cm-activeLine {
        background-color: theme('colors.primary.DEFAULT / 10%');
    }
    .cm-theme-custom .cm-activeLineGutter {
        background-color: theme('colors.primary.DEFAULT / 15%');
    }
    .cm-theme-custom .cm-placeholder {
        color: theme('colors.muted.foreground');
        font-style: italic;
        pointer-events: none;
        padding: 14px 16px; /* Match content padding */
        position: absolute;
        top: 0;
        left: 0;
    }
    .cm-theme-custom .cm-foldGutter .cm-gutterElement {
        padding: 0 4px 0 8px;
        cursor: pointer;
        text-align: center;
    }
    .cm-theme-custom .cm-foldMarker {
        display: inline-block;
        color: hsl(210, 10%, 70%);
    }
    .cm-theme-custom .cm-foldMarker:hover {
        color: hsl(210, 10%, 50%);
    }
    .cm-theme-custom .cm-searchMatch {
        background-color: hsla(50, 100%, 50%, 0.35);
        outline: 1px solid hsla(50, 100%, 50%, 0.5);
        border-radius: 2px;
    }
    .cm-theme-custom .cm-searchMatch-selected {
        background-color: hsla(50, 100%, 50%, 0.55);
        outline: 1px solid hsla(50, 100%, 40%, 0.8);
    }
    .cm-theme-custom .cm-selectionBackground {
        background-color: theme('colors.primary.DEFAULT / 25%') !important;
    }
    .cm-theme-custom.cm-focused {
        outline: none !important;
    }
    /* Ensure Radix content can have backdrop blur */
    [data-radix-popper-content-wrapper] {
        z-index: 50; /* Default z-index */
    }
}